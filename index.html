<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nurillo Teacherman - Braille</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: #f4f6f9; }
    .container { max-width: 800px; margin: auto; background: white; border-radius: 16px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #2c3e50; }
    .menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
    .btn { padding: 16px; font-size: 16px; background: #3498db; color: white; border: none; border-radius: 12px; cursor: pointer; text-align: center; transition: 0.3s; }
    .btn:hover { background: #2980b9; transform: translateY(-2px); }
    .section { display: none; margin-top: 20px; }
    .active { display: block; }
    textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
    .braille-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; max-width: 200px; margin: 20px auto; }
    .dot { width: 50px; height: 50px; background: #eee; border-radius: 50%; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666; }
    .dot.active { background: #2c3e50; color: white; }
    .result { margin-top: 15px; padding: 15px; background: #e8f5e9; border-radius: 8px; font-family: monospace; }
    .stats { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .refresh-btn { background: #e74c3c; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nurillo Teacherman</h1>
    <p style="text-align:center;">Braille o‘qish va yozish (Oyna usuli)</p>

    <div class="menu">
      <div class="btn" onclick="show('translate')">Tarjima</div>
      <div class="btn" onclick="show('learn-read')">O‘qish</div>
      <div class="btn" onclick="show('learn-write')">Yozish</div>
      <div class="btn" onclick="show('game-read')">O‘yin: O‘qish</div>
      <div class="btn" onclick="show('game-write')">O‘yin: Yozish</div>
      <div class="btn" onclick="showStats()">Statistikalar</div>
    </div>

    <!-- Tarjima -->
    <div id="translate" class="section active">
      <h3>Matn → Braille</h3>
      <textarea id="text-input" placeholder="SALOM"></textarea>
      <button class="btn" onclick="translateText()">Tarjima</button>
      <div id="translate-result" class="result"></div>
    </div>

    <!-- O‘qish -->
    <div id="learn-read" class="section">
      <h3>O‘qishni o‘rganamiz</h3>
      <p id="read-letter"></p>
      <div class="braille-grid" id="read-grid"></div>
      <button class="btn" onclick="checkRead()">Tekshirish</button>
      <button class="btn refresh-btn" onclick="startLearnRead()">Yangi harf</button>
      <div id="read-result" class="result"></div>
    </div>

    <!-- Yozish -->
    <div id="learn-write" class="section">
      <h3>Yozishni o‘rganamiz</h3>
      <p id="write-letter"></p>
      <div class="braille-grid" id="write-grid"></div>
      <button class="btn" onclick="checkWrite()">Tekshirish</button>
      <button class="btn refresh-btn" onclick="startLearnWrite()">Yangi harf</button>
      <div id="write-result" class="result"></div>
    </div>

    <!-- O‘yin: O‘qish -->
    <div id="game-read" class="section">
      <h3>O‘yin: O‘qish</h3>
      <p id="game-read-letter"></p>
      <div class="braille-grid" id="game-read-grid"></div>
      <button class="btn" onclick="checkGameRead()">Javob</button>
      <button class="btn refresh-btn" onclick="startGameRead()">Yangi</button>
      <div id="game-read-result" class="result"></div>
    </div>

    <!-- O‘yin: Yozish -->
    <div id="game-write" class="section">
      <h3>O‘yin: Yozish</h3>
      <p id="game-write-letter"></p>
      <div class="braille-grid" id="game-write-grid"></div>
      <button class="btn" onclick="checkGameWrite()">Javob</button>
      <button class="btn refresh-btn" onclick="startGameWrite()">Yangi</button>
      <div id="game-write-result" class="result"></div>
    </div>

    <!-- Statistikalar -->
    <div id="stats" class="section">
      <h3>Statistikalar</h3>
      <div class="stats" id="stats-content"></div>
    </div>
  </div>

  <script>
    // BRAILLE KODLARI (o‘qish uchun — chapda 1-2-3)
    const KODLAR = {
      'A': '1', 'B': '1-2', 'D': '1-4-5', 'E': '1-5',
      'F': '1-2-4', 'G': '1-2-4-5', 'H': '1-4-5-6', 'I': '2-4', 'J': '2-4-5',
      'K': '1-3', 'L': '1-2-3', 'M': '1-3-4', 'N': '1-3-4-5', 'O': '1-3-5',
      'P': '1-2-3-4', 'Q': '1-3-4-5-6', 'R': '1-2-3-5', 'S': '2-3-4', 'T': '2-3-4-5',
      'U': '1-2-6', 'V': '2-4-5-6', 'X': '1-2-5',
      'Y': '1-2-3-4-6', 'Z': '1-3-5-6'
    };

    // YOZISH UCHUN: 1-2-3 → o‘ng ustun (1-2-3), 4-5-6 → chap ustun (4-5-6)
    const MIRROR = {1:4, 2:5, 3:6, 4:1, 5:2, 6:3};

    let state = { score: 0, correct: 0, wrong: 0, currentLetter: '', expected: [], selected: [] };

    function show(section) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(section).classList.add('active');
      if (section === 'learn-read') startLearnRead();
      if (section === 'learn-write') startLearnWrite();
      if (section === 'game-read') startGameRead();
      if (section === 'game-write') startGameWrite();
    }

    function createGrid(id, mode = 'read') {
      const grid = document.getElementById(id);
      grid.innerHTML = '';
      const order = mode === 'write' ? [4,1,5,2,6,3] : [1,4,2,5,3,6];
      order.forEach(num => {
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.textContent = num;
        dot.dataset.num = num;
        dot.onclick = () => toggleDot(dot);
        grid.appendChild(dot);
      });
    }

    function toggleDot(dot) {
      dot.classList.toggle('active');
      const num = parseInt(dot.dataset.num);
      if (dot.classList.contains('active') && !state.selected.includes(num)) {
        state.selected.push(num);
      } else {
        state.selected = state.selected.filter(n => n !== num);
      }
    }

    function randomLetter() {
      const letters = Object.keys(KODLAR);
      return letters[Math.floor(Math.random() * letters.length)];
    }

    // O‘QISH
    function startLearnRead() {
      const letter = randomLetter();
      state.currentLetter = letter;
      state.expected = KODLAR[letter].split('-').map(Number).sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('read-letter').innerHTML = `Harf: <b>${letter}</b> → <b>${KODLAR[letter]}</b>`;
      createGrid('read-grid', 'read');
      document.getElementById('read-result').innerHTML = '';
    }

    function checkRead() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('read-result');
      if (correct) {
        res.innerHTML = 'To‘g‘ri!';
        setTimeout(startLearnRead, 1500);
      } else {
        res.innerHTML = `Xato. To‘g‘ri: ${state.expected.join('-')}`;
      }
    }

    // YOZISH
    function startLearnWrite() {
      const letter = randomLetter();
      state.currentLetter = letter;
      const readCode = KODLAR[letter].split('-').map(Number);
      const writeCode = readCode.map(n => MIRROR[n]);
      state.expected = writeCode.sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('write-letter').innerHTML = `Harf: <b>${letter}</b> → Yozing: <b>${state.expected.join('-')}</b>`;
      createGrid('write-grid', 'write');
      document.getElementById('write-result').innerHTML = '';
    }

    function checkWrite() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('write-result');
      if (correct) {
        res.innerHTML = 'To‘g‘ri!';
        setTimeout(startLearnWrite, 1500);
      } else {
        res.innerHTML = `Xato. To‘g‘ri: ${state.expected.join('-')}`;
      }
    }

    // O‘yinlar
    function startGameRead() { startLearnRead(); document.getElementById('game-read-letter').innerHTML = document.getElementById('read-letter').innerHTML; createGrid('game-read-grid', 'read'); }
    function checkGameRead() { checkRead(); document.getElementById('game-read-result').innerHTML = document.getElementById('read-result').innerHTML; if (document.getElementById('read-result').innerHTML.includes('To‘g‘ri')) { state.score += 10; state.correct++; saveStats(); setTimeout(startGameRead, 1500); } else { state.wrong++; saveStats(); } }
    function startGameWrite() { startLearnWrite(); document.getElementById('game-write-letter').innerHTML = document.getElementById('write-letter').innerHTML; createGrid('game-write-grid', 'write'); }
    function checkGameWrite() { checkWrite(); document.getElementById('game-write-result').innerHTML = document.getElementById('write-result').innerHTML; if (document.getElementById('write-result').innerHTML.includes('To‘g‘ri')) { state.score += 10; state.correct++; saveStats(); setTimeout(startGameWrite, 1500); } else { state.wrong++; saveStats(); } }

    function translateText() {
      const text = document.getElementById('text-input').value.toUpperCase();
      const result = text.split('').map(c => KODLAR[c] || '?').join(', ');
      document.getElementById('translate-result').innerHTML = `<b>Braille:</b> ${result}`;
    }

    function saveStats() { localStorage.setItem('braille_stats', JSON.stringify(state)); }
    function showStats() {
      const s = JSON.parse(localStorage.getItem('braille_stats') || '{}');
      document.getElementById('stats-content').innerHTML = `Ball: <b>${s.score||0}</b> | To‘g‘ri: <b>${s.correct||0}</b> | Xato: <b>${s.wrong||0}</b>`;
      show('stats');
    }

    show('translate');
  </script>
</body>
</html>
