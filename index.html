<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nurillo Teacherman - Braille</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: #f4f6f9; }
    .container { max-width: 800px; margin: auto; background: white; border-radius: 16px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #2c3e50; }
    .menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
    .btn { padding: 16px; font-size: 16px; background: #3498db; color: white; border: none; border-radius: 12px; cursor: pointer; text-align: center; transition: 0.3s; }
    .btn:hover { background: #2980b9; transform: translateY(-2px); }
    .section { display: none; margin-top: 20px; }
    .active { display: block; }
    input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
    .braille-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; max-width: 200px; margin: 20px auto; }
    .dot { width: 50px; height: 50px; background: #eee; border-radius: 50%; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666; }
    .dot.active { background: #2c3e50; color: white; }
    .result { margin-top: 15px; padding: 15px; background: #e8f5e9; border-radius: 8px; font-family: monospace; }
    .lesson { line-height: 1.8; }
    .test-btn { background: #27ae60; margin: 5px; padding: 10px; color: white; border: none; border-radius: 8px; cursor: pointer; display: inline-block; }
    .stats { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .refresh-btn { background: #e74c3c; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nurillo Teacherman</h1>
    <p style="text-align:center;">Braille o‘qish, yozish va darslar</p>

    <div class="menu">
      <div class="btn" onclick="show('translate')">Tarjima</div>
      <div class="btn" onclick="show('learn-read')">O‘qish</div>
      <div class="btn" onclick="show('learn-write')">Yozish</div>
      <div class="btn" onclick="show('game-read')">O‘yin: O‘qish</div>
      <div class="btn" onclick="show('game-write')">O‘yin: Yozish</div>
      <div class="btn" onclick="show('tiflopedagogika')">Tiflopedagogika</div>
      <div class="btn" onclick="show('tiflografiya')">Tiflografiya</div>
      <div class="btn" onclick="showStats()">Statistikalar</div>
    </div>

    <!-- Tarjima -->
    <div id="translate" class="section active">
      <h3>Matn to Braille</h3>
      <textarea id="text-input" placeholder="Matn kiriting (masalan: SALOM) yoki Braille kod (1-2-4, 1-5)"></textarea>
      <button class="btn" onclick="translateText()">Tarjima qilish</button>
      <div id="translate-result" class="result"></div>
    </div>

    <!-- O‘qish o‘rganish -->
    <div id="learn-read" class="section">
      <h3>O‘qishni o‘rganamiz</h3>
      <p id="read-letter"></p>
      <div class="braille-grid" id="read-grid"></div>
      <button class="btn" onclick="checkRead()">Tekshirish</button>
      <button class="btn refresh-btn" onclick="startLearnRead()">Yangi harf</button>
      <div id="read-result" class="result"></div>
    </div>

    <!-- Yozish o‘rganish -->
    <div id="learn-write" class="section">
      <h3>Yozishni o‘rganamiz</h3>
      <p id="write-letter"></p>
      <div class="braille-grid" id="write-grid"></div>
      <button class="btn" onclick="checkWrite()">Tekshirish</button>
      <button class="btn refresh-btn" onclick="startLearnWrite()">Yangi harf</button>
      <div id="write-result" class="result"></div>
    </div>

    <!-- O‘yin: O‘qish -->
    <div id="game-read" class="section">
      <h3>O‘yin: O‘qish</h3>
      <p id="game-read-letter"></p>
      <div class="braille-grid" id="game-read-grid"></div>
      <button class="btn" onclick="checkGameRead()">Javob berish</button>
      <button class="btn refresh-btn" onclick="startGameRead()">Yangi harf</button>
      <div id="game-read-result" class="result"></div>
    </div>

    <!-- Tiflopedagogika -->
    <div id="tiflopedagogika" class="section">
      <h3>Tiflopedagogika darslari</h3>
      <div id="ped-lessons"></div>
    </div>

    <!-- Tiflografiya -->
    <div id="tiflografiya" class="section">
      <h3>Tiflografiya darslari</h3>
      <div id="graf-lessons"></div>
    </div>

    <!-- Statistikalar -->
    <div id="stats" class="section">
      <h3>Statistikalar</h3>
      <div class="stats" id="stats-content"></div>
    </div>
  </div>

  <script>
    // Braille kodlari
    const kodlar = {
      'A': '1', 'B': '1-2', 'D': '1-4-5', 'E': '1-5', 'F': '1-2-4', 'G': '1-2-4-5',
      'H': '1-3-4-6', 'I': '2-4', 'J': '2-4-5', 'K': '1-3', 'L': '1-2-3', 'M': '1-3-4',
      'N': '1-3-4-5', 'O': '1-3-5', 'P': '1-2-3-4', 'Q': '1-3-4-5-6', 'R': '1-2-3-5',
      'S': '2-3-4', 'T': '2-3-4-5', 'U': '1-2-6', 'V': '2-4-5-6', 'X': '1-2-5',
      'Y': '1-2-3-4-6', 'Z': '1-3-5-6', "G'": '1-2-4-5-6', "CH": '1-2-3-4-5',
      "SH": '1-5-6', "O'": '1-2-3-6', "NG": '1-3-4-5-1-2-4-5'
    };
    const WRITE_TO_READ = {1:4,2:5,3:6,4:1,5:2,6:3};

    // Holat
    let state = { score: 0, correct: 0, wrong: 0, currentLetter: '', expected: [], selected: [] };

    // Darslar + Testlar
    const tiflopedagogika_lessons = {
      1: { title: "1-dars: Maxsus pedagogika haqida", text: "Maxsus pedagogika — nogironligi bo‘lgan bolalar va kattalar ta’lim-tarbiyasi bilan shug‘ullanadigan fan...", 
        tests: [["Kimlar bilan ishlaydi?", ["Bolalar", "Nogironlar"], "Nogironlar"], ["Qaysi fan?", ["Tiflopedagogika", "Fizika"], "Tiflopedagogika"]] },
      2: { title: "2-dars: Tiflopedagogika usullari", text: "Braille, audio, taktil...", 
        tests: [["Asosiy usul?", ["Braille", "Rasm"], "Braille"]] },
      3: { title: "3-dars: Moslashtirish", text: "Individual reja, Braille printer...", 
        tests: [["Nima kerak?", ["Reja", "Dam"], "Reja"]] },
      4: { title: "4-dars: Ijtimoiy integratsiya", text: "Guruhli mashqlar...", 
        tests: [["Nima muhim?", ["Guruh", "Yolg‘iz"], "Guruh"]] },
      5: { title: "5-dars: Texnologiyalar", text: "Braille displey, Seeing AI...", 
        tests: [["Texnologiya?", ["Braille displey", "Telefon"], "Braille displey"]] }
    };

    const tiflografiya_lessons = {
      1: { title: "1-dars: Lui Brail", text: "Louis Braille 1809–1852...", 
        tests: [["Qachon yashagan?", ["XIX asr", "XX asr"], "XIX asr"]] },
      2: { title: "2-dars: Brail tizimi", text: "6 nuqta, 64 kombinatsiya...", 
        tests: [["Necha nuqta?", ["6", "8"], "6"]] },
      3: { title: "3-dars: Harflar", text: "A=1, B=1-2...", 
        tests: [["A harfi?", ["1", "1-2"], "1"]] },
      4: { title: "4-dars: Belgilar", text: "Bo‘sh joy=/, kapital=6...", 
        tests: [["Bo‘sh joy?", ["/", "1"], "/"]] },
      5: { title: "5-dars: Amaliyot", text: "Kitoblar, lift tugmalari...", 
        tests: [["Qayerda ishlatiladi?", ["Kitoblar", "O‘yin"], "Kitoblar"]] }
    };

    let currentTest = null;

    function show(section) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(section).classList.add('active');
      if (section === 'learn-read') startLearnRead();
      if (section === 'learn-write') startLearnWrite();
      if (section === 'game-read') startGameRead();
      if (section === 'tiflopedagogika') showLessons('ped', tiflopedagogika_lessons);
      if (section === 'tiflografiya') showLessons('graf', tiflografiya_lessons);
    }

    function translateText() {
      const input = document.getElementById('text-input').value.trim();
      let result = '';
      if (/^[0-9,\-/\s]+$/.test(input)) {
        result = brailleToText(input);
      } else {
        result = textToBraille(input);
      }
      document.getElementById('translate-result').innerHTML = `<b>Natija:</b> ${result}`;
    }

    function textToBraille(text) {
      return text.toUpperCase().split('').map(c => c === ' ' ? '/' : (kodlar[c] || '?')).join(', ');
    }

    function brailleToText(braille) {
      const parts = braille.split(/[\s,]+/).filter(Boolean);
      return parts.map(p => {
        if (p === '/') return ' ';
        const mapped = p.split('-').map(n => WRITE_TO_READ[parseInt(n)] || parseInt(n)).join('-');
        return Object.entries(kodlar).find(([k,v]) => v === mapped)?.[0] || '?';
      }).join('');
    }

    function createBrailleGrid(id, mode = 'read') {
      const grid = document.getElementById(id);
      grid.innerHTML = '';
      const order = mode === 'write' ? [4,1,5,2,6,3] : [1,4,2,5,3,6];
      order.forEach(num => {
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.textContent = num;
        dot.dataset.num = num;
        dot.onclick = () => toggleDot(dot);
        grid.appendChild(dot);
      });
    }

    function toggleDot(dot) {
      dot.classList.toggle('active');
      const num = parseInt(dot.dataset.num);
      if (dot.classList.contains('active')) {
        if (!state.selected.includes(num)) state.selected.push(num);
      } else {
        state.selected = state.selected.filter(n => n !== num);
      }
    }

    function randomLetter() {
      const letters = Object.keys(kodlar);
      return letters[Math.floor(Math.random() * letters.length)];
    }

    function startLearnRead() {
      const letter = randomLetter();
      state.currentLetter = letter;
      state.expected = kodlar[letter].split('-').map(Number).sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('read-letter').innerHTML = `Harf: <b>${letter}</b> → Kod: <b>${kodlar[letter]}</b>`;
      createBrailleGrid('read-grid', 'read');
      document.getElementById('read-result').innerHTML = '';
    }

    function checkRead() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('read-result');
      if (correct) {
        res.innerHTML = 'To‘g‘ri!';
        setTimeout(startLearnRead, 1500);
      } else {
        res.innerHTML = `Xato. To‘g‘ri: ${state.expected.join('-')}`;
      }
    }

    function startLearnWrite() {
      const letter = randomLetter();
      state.currentLetter = letter;
      const writeCode = kodlar[letter].split('-').map(n => WRITE_TO_READ[parseInt(n)] || parseInt(n));
      state.expected = writeCode.sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('write-letter').innerHTML = `Harf: <b>${letter}</b> → Yozing (o‘ngdan)`;
      createBrailleGrid('write-grid', 'write');
      document.getElementById('write-result').innerHTML = '';
    }

    function checkWrite() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('write-result');
      if (correct) {
        res.innerHTML = 'To‘g‘ri!';
        setTimeout(startLearnWrite, 1500);
      } else {
        res.innerHTML = `Xato. To‘g‘ri: ${state.expected.join('-')}`;
      }
    }

    function startGameRead() {
      const letter = randomLetter();
      state.currentLetter = letter;
      state.expected = kodlar[letter].split('-').map(Number).sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('game-read-letter').innerHTML = `Harf: <b>${letter}</b>`;
      createBrailleGrid('game-read-grid', 'read');
      document.getElementById('game-read-result').innerHTML = '';
    }

    function checkGameRead() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const res = document.getElementById('game-read-result');
      if (JSON.stringify(selected) === JSON.stringify(state.expected)) {
        state.score += 10;
        state.correct += 1;
        res.innerHTML = `To‘g‘ri! (+10 ball) Jami: ${state.score}`;
        saveStats();
        setTimeout(startGameRead, 1500);
      } else {
        state.wrong += 1;
        res.innerHTML = `Xato. To‘g‘ri: ${state.expected.join('-')}`;
        saveStats();
      }
    }

    function saveStats() {
      localStorage.setItem('braille_stats', JSON.stringify(state));
    }

    function showStats() {
      const saved = JSON.parse(localStorage.getItem('braille_stats') || '{}');
      document.getElementById('stats-content').innerHTML = `
        Ballar: <b>${saved.score || 0}</b><br>
        To‘g‘ri: <b>${saved.correct || 0}</b><br>
        Xato: <b>${saved.wrong || 0}</b>
      `;
      show('stats');
    }

    function showLessons(prefix, lessons) {
      const container = document.getElementById(prefix + '-lessons');
      container.innerHTML = Object.entries(lessons).map(([i, l]) => `
        <div style="margin:15px 0; padding:15px; border:1px solid #eee; border-radius:8px;">
          <b>${l.title}</b><br><br>
          <div class="lesson">${l.text.replace(/\n/g, '<br>')}</div>
          ${l.tests ? `
            <button class="test-btn" onclick="startTest(${i}, '${prefix}')">Testni boshlash</button>
            <div id="test-${prefix}-${i}" style="margin-top:10px;"></div>
          ` : ''}
        </div>
      `).join('');
    }

    function startTest(lessonId, prefix) {
      const lessons = prefix === 'ped' ? tiflopedagogika_lessons : tiflografiya_lessons;
      currentTest = { lessonId, prefix, q: 0, correct: 0 };
      showTestQuestion();
    }

    function showTestQuestion() {
      if (!currentTest) return;
      const { lessonId, prefix, q } = currentTest;
      const lessons = prefix === 'ped' ? tiflopedagogika_lessons : tiflografiya_lessons;
      const test = lessons[lessonId].tests[q];
      if (!test) {
        document.getElementById(`test-${prefix}-${lessonId}`).innerHTML = 
          `<b style="color:green;">Test tugadi! To‘g‘ri: ${currentTest.correct}/${lessons[lessonId].tests.length}</b>`;
        currentTest = null;
        return;
      }
      const [question, options, correct] = test;
      const html = `
        <p><b>${question}</b></p>
        ${options.map(opt => `
          <button class="test-btn" onclick="checkTestAnswer('${opt}', '${correct}', ${q})">${opt}</button>
        `).join('')}
      `;
      document.getElementById(`test-${prefix}-${lessonId}`).innerHTML = html;
    }

    function checkTestAnswer(chosen, correct, q) {
      if (chosen === correct) {
        currentTest.correct++;
        alert("To‘g‘ri!");
      } else {
        alert(`Xato! To‘g‘ri: ${correct}`);
      }
      currentTest.q++;
      showTestQuestion();
    }

    // Boshlash
    show('translate');
  </script>
</body>
</html>
