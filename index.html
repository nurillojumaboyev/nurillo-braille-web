<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nurillo Teacherman - Braille</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
    .container { max-width: 800px; margin: auto; background: rgba(255,255,255,0.95); border-radius: 24px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transform-style: preserve-3d; }
    h1 { text-align: center; color: #2c3e50; font-size: 2.5rem; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .subtitle { text-align: center; color: #7f8c8d; font-size: 1.1rem; margin-bottom: 20px; }

    .menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
    .menu-item { position: relative; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.15); transition: all 0.3s; cursor: pointer; }
    .menu-item:hover { transform: translateY(-10px) rotateX(5deg); box-shadow: 0 20px 40px rgba(0,0,0,0.25); }
    .menu-btn { padding: 20px; font-size: 16px; font-weight: bold; text-align: center; color: white; }
    .menu-desc { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 12px; opacity: 0; transition: opacity 0.3s; }
    .menu-item:hover .menu-desc { opacity: 1; }

    .btn-translate { background: linear-gradient(135deg, #3498db, #2980b9); }
    .btn-learn-read { background: linear-gradient(135deg, #27ae60, #2ecc71); }
    .btn-learn-write { background: linear-gradient(135deg, #e67e22, #f39c12); }
    .btn-game-read { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
    .btn-game-write { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    .btn-stats { background: linear-gradient(135deg, #34495e, #2c3e50); }

    .section { display: none; margin-top: 20px; }
    .active { display: block; }
    textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
    .braille-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; max-width: 200px; margin: 20px auto; }
    .dot { width: 50px; height: 50px; background: #eee; border-radius: 50%; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .dot:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
    .dot.active { background: #2c3e50; color: white; transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.3); }
    .result { margin-top: 15px; padding: 15px; background: #e8f5e9; border-radius: 8px; font-family: monospace; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .stats { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .refresh-btn { background: #e74c3c; margin-top: 10px; color: white; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .refresh-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nurillo Teacherman</h1>
    <p class="subtitle">Braille o'qish, yozish va o'yinlar</p>

    <div class="menu">
      <div class="menu-item btn-translate" onclick="show('translate')">
        <div class="menu-btn">Tarjima</div>
        <div class="menu-desc">Matnni Braille kodiga yoki aksincha tarjima qilish</div>
      </div>
      <div class="menu-item btn-learn-read" onclick="show('learn-read')">
        <div class="menu-btn">O'qish</div>
        <div class="menu-desc">Nuqtalar orqali harfni o'qishni o'rganish</div>
      </div>
      <div class="menu-item btn-learn-write" onclick="show('learn-write')">
        <div class="menu-btn">Yozish</div>
        <div class="menu-desc">Harfni eshitib, nuqtalar bosishni o'rganish</div>
      </div>
      <div class="menu-item btn-game-read" onclick="show('game-read')">
        <div class="menu-btn">O'yin: O'qish</div>
        <div class="menu-desc">Tezlikda o'qish va ball to'plash</div>
      </div>
      <div class="menu-item btn-game-write" onclick="show('game-write')">
        <div class="menu-btn">O'yin: Yozish</div>
        <div class="menu-desc">Tezlikda yozish va xato qilmaslik</div>
      </div>
      <div class="menu-item btn-stats" onclick="showStats()">
        <div class="menu-btn">Statistikalar</div>
        <div class="menu-desc">Sizning ballar va natijalaringiz</div>
      </div>
    </div>

    <!-- Tarjima -->
    <div id="translate" class="section active">
      <h3>Matn ↔ Braille</h3>
      <textarea id="text-input" placeholder="SALOM yozing yoki 1-2-3, 1-5"></textarea>
      <button class="btn btn-translate" onclick="translateText()">Tarjima qilish</button>
      <div id="translate-result" class="result"></div>
    </div>

    <!-- O'qish -->
    <div id="learn-read" class="section">
      <h3>O'qishni o'rganamiz</h3>
      <p id="read-letter"></p>
      <div class="braille-grid" id="read-grid"></div>
      <button class="btn btn-learn-read" onclick="checkRead()">Tekshirish</button>
      <button class="refresh-btn" onclick="startLearnRead()">Yangi harf</button>
      <div id="read-result" class="result"></div>
    </div>

    <!-- Yozish -->
    <div id="learn-write" class="section">
      <h3>Yozishni o'rganamiz</h3>
      <p id="write-letter"></p>
      <div class="braille-grid" id="write-grid"></div>
      <button class="btn btn-learn-write" onclick="checkWrite()">Tekshirish</button>
      <button class="refresh-btn" onclick="startLearnWrite()">Yangi harf</button>
      <div id="write-result" class="result"></div>
    </div>

    <!-- O'yin: O'qish -->
    <div id="game-read" class="section">
      <h3>O'yin: O'qish</h3>
      <p id="game-read-letter"></p>
      <div class="braille-grid" id="game-read-grid"></div>
      <button class="btn btn-game-read" onclick="checkGameRead()">Javob berish</button>
      <button class="refresh-btn" onclick="startGameRead()">Yangi harf</button>
      <div id="game-read-result" class="result"></div>
    </div>

    <!-- O'yin: Yozish -->
    <div id="game-write" class="section">
      <h3>O'yin: Yozish</h3>
      <p id="game-write-letter"></p>
      <div class="braille-grid" id="game-write-grid"></div>
      <button class="btn btn-game-write" onclick="checkGameWrite()">Javob berish</button>
      <button class="refresh-btn" onclick="startGameWrite()">Yangi harf</button>
      <div id="game-write-result" class="result"></div>
    </div>

    <!-- Statistikalar -->
    <div id="stats" class="section">
      <h3>Statistikalar</h3>
      <div class="stats" id="stats-content">Yuklanmoqda...</div>
    </div>
  </div>

  <script>
    // TO'RI BRAILLE JADVALI (sizning jadvalingiz)
    const kodlar = {
      'A': '1', 'B': '1-2', 'D': '1-4-5', 'E': '1-5',
      'F': '1-2-4', 'G': '1-2-4-5', 'H': '1-4-5-6', 'I': '2-4', 'J': '2-4-5',
      'K': '1-3', 'L': '1-2-3', 'M': '1-3-4', 'N': '1-3-4-5', 'O': '1-3-5',
      'P': '1-2-3-4', 'Q': '1-3-4-5-6', 'R': '1-2-3-3', 'S': '2-3-4', 'T': '2-3-4-5',
      'U': '1-2-6', 'V': '2-4-5-6', 'X': '1-2-5',
      'Y': '1-2-3-4-6', 'Z': '1-3-5-6', "G'": '1-2-4-5-6', "CH": '1-2-3-4-5',
      "SH": '1-5-6', "O'": '1-2-3-6', "NG": '1-3-4-5-1-2-4-5'
    };

    const MIRROR = {1:4, 2:5, 3:6, 4:1, 5:2, 6:3};
    let state = { score: 0, correct: 0, wrong: 0, currentLetter: '', expected: [], selected: [] };

    function show(section) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(section).classList.add('active');
      if (section === 'learn-read') startLearnRead();
      if (section === 'learn-write') startLearnWrite();
      if (section === 'game-read') startGameRead();
      if (section === 'game-write') startGameWrite();
    }

    function translateText() {
      const input = document.getElementById('text-input').value.trim().toUpperCase();
      let result = '';
      if (/^[0-9,\-/\s]+$/.test(input)) {
        result = brailleToText(input);
      } else {
        result = textToBraille(input);
      }
      document.getElementById('translate-result').innerHTML = `<b>Natija:</b> ${result}`;
    }

    function textToBraille(text) {
      return text.split('').map(c => kodlar[c] || '?').join(', ');
    }

    function brailleToText(braille) {
      const parts = braille.split(/[\s,]+/).filter(Boolean);
      return parts.map(p => {
        if (p === '/') return ' ';
        const mapped = p.split('-').map(n => MIRROR[parseInt(n)] || parseInt(n)).join('-');
        return Object.entries(kodlar).find(([k,v]) => v === mapped)?.[0] || '?';
      }).join('');
    }

    function createBrailleGrid(id, mode = 'read') {
      const grid = document.getElementById(id);
      grid.innerHTML = '';
      const order = mode === 'write' ? [4,1,5,2,6,3] : [1,4,2,5,3,6];
      order.forEach(num => {
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.textContent = num;
        dot.dataset.num = num;
        dot.onclick = () => toggleDot(dot);
        grid.appendChild(dot);
      });
    }

    function toggleDot(dot) {
      dot.classList.toggle('active');
      const num = parseInt(dot.dataset.num);
      if (dot.classList.contains('active')) {
        if (!state.selected.includes(num)) state.selected.push(num);
      } else {
        state.selected = state.selected.filter(n => n !== num);
      }
    }

    function randomLetter() {
      const letters = Object.keys(kodlar);
      return letters[Math.floor(Math.random() * letters.length)];
    }

    // O'qish
    function startLearnRead() {
      const letter = randomLetter();
      state.currentLetter = letter;
      state.expected = kodlar[letter].split('-').map(Number).sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('read-letter').innerHTML = `Harf: <b>${letter}</b> → Kod: <b>${kodlar[letter]}</b>`;
      createBrailleGrid('read-grid', 'read');
      document.getElementById('read-result').innerHTML = '';
    }

    function checkRead() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('read-result');
      if (correct) {
        res.innerHTML = 'To'g'ri!';
        setTimeout(startLearnRead, 1500);
      } else {
        res.innerHTML = `Xato. To'g'ri: ${state.expected.join('-')}`;
      }
    }

    // Yozish
    function startLearnWrite() {
      const letter = randomLetter();
      state.currentLetter = letter;
      const readCode = kodlar[letter].split('-').map(Number);
      const writeCode = readCode.map(n => MIRROR[n]);
      const writeCodeStr = writeCode.sort((a,b)=>a-b).join('-');
      state.expected = writeCode.sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('write-letter').innerHTML = `Harf: <b>${letter}</b> → Yozing (o'ngdan): <b>${writeCodeStr}</b>`;
      createBrailleGrid('write-grid', 'write');
      document.getElementById('write-result').innerHTML = '';
    }

    function checkWrite() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const correct = JSON.stringify(selected) === JSON.stringify(state.expected);
      const res = document.getElementById('write-result');
      if (correct) {
        res.innerHTML = 'To'g'ri!';
        setTimeout(startLearnWrite, 1500);
      } else {
        res.innerHTML = `Xato. To'g'ri: ${state.expected.join('-')}`;
      }
    }

    // O'yin: O'qish (javob ko'rinmaydi)
    function startGameRead() {
      const letter = randomLetter();
      state.currentLetter = letter;
      state.expected = kodlar[letter].split('-').map(Number).sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('game-read-letter').innerHTML = `<b>${letter}</b>`;
      createBrailleGrid('game-read-grid', 'read');
      document.getElementById('game-read-result').innerHTML = '';
    }

    function checkGameRead() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const res = document.getElementById('game-read-result');
      if (JSON.stringify(selected) === JSON.stringify(state.expected)) {
        state.score += 10;
        state.correct += 1;
        res.innerHTML = `To'g'ri! (+10 ball) Jami: ${state.score}`;
        saveStats();
        setTimeout(startGameRead, 1500);
      } else {
        state.wrong += 1;
        res.innerHTML = `Xato. To'g'ri: ${state.expected.join('-')}`;
        saveStats();
      }
    }

    // O'yin: Yozish (javob ko'rinmaydi)
    function startGameWrite() {
      const letter = randomLetter();
      state.currentLetter = letter;
      const readCode = kodlar[letter].split('-').map(Number);
      const writeCode = readCode.map(n => MIRROR[n]);
      state.expected = writeCode.sort((a,b)=>a-b);
      state.selected = [];
      document.getElementById('game-write-letter').innerHTML = `<b>${letter}</b>`;
      createBrailleGrid('game-write-grid', 'write');
      document.getElementById('game-write-result').innerHTML = '';
    }

    function checkGameWrite() {
      const selected = [...state.selected].sort((a,b)=>a-b);
      const res = document.getElementById('game-write-result');
      if (JSON.stringify(selected) === JSON.stringify(state.expected)) {
        state.score += 10;
        state.correct += 1;
        res.innerHTML = `To'g'ri! (+10 ball) Jami: ${state.score}`;
        saveStats();
        setTimeout(startGameWrite, 1500);
      } else {
        state.wrong += 1;
        res.innerHTML = `Xato. To'g'ri: ${state.expected.join('-')}`;
        saveStats();
      }
    }

    function saveStats() {
      localStorage.setItem('braille_stats', JSON.stringify(state));
    }

    function showStats() {
      const saved = JSON.parse(localStorage.getItem('braille_stats') || '{}');
      document.getElementById('stats-content').innerHTML = `
        Ballar: <b>${saved.score || 0}</b><br>
        To'g'ri javoblar: <b>${saved.correct || 0}</b><br>
        Xato javoblar: <b>${saved.wrong || 0}</b>
      `;
      show('stats');
    }

    show('translate');
  </script>
</body>
</html>
